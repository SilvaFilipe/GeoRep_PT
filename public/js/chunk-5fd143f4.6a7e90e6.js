(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fd143f4"],{"72cb":function(t,e,a){"use strict";var i=a("c077"),s=a.n(i);s.a},c077:function(t,e,a){},d4f4:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"flex"}},[a("div",[a("DistrictsMap",{attrs:{id:"districtMap",mapHeight:"350",zoomProp:6,centerCoords:t.districtsMapCenterCoords},on:{pickedDistrictChanged:t.pickedDistrictChanged,pickedCountyChanged:t.pickedCountyChanged,districtsMapBack:t.resetValidationsTable}}),a("table",{staticStyle:{width:"100%"}},[a("tr",[a("td",[a("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.showInitialized,expression:"showInitialized"}],attrs:{color:"grey"},on:{click:function(e){t.showInitialized=!t.showInitialized}}},[t._v("mdi-eye")]),a("v-icon",{directives:[{name:"show",rawName:"v-show",value:!t.showInitialized,expression:"!showInitialized"}],attrs:{color:"grey"},on:{click:function(e){t.showInitialized=!t.showInitialized}}},[t._v("mdi-eye-off")])],1),a("td",[t._v(t._s(t.$t("validation.initialized")))]),a("td",[a("v-chip",{staticClass:"ma-2 chip-quantity",attrs:{small:""}},[a("td",[t._v(t._s(t.initializedQuantity))])])],1),a("td",[a("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.showValidated,expression:"showValidated"}],attrs:{color:"grey"},on:{click:function(e){t.showValidated=!t.showValidated}}},[t._v("mdi-eye")]),a("v-icon",{directives:[{name:"show",rawName:"v-show",value:!t.showValidated,expression:"!showValidated"}],attrs:{color:"grey"},on:{click:function(e){t.showValidated=!t.showValidated}}},[t._v("mdi-eye-off")])],1),a("td",[t._v(t._s(t.$t("validation.validated")))]),a("td",[a("v-chip",{staticClass:"ma-2",attrs:{small:"",color:"#a6e1ef57","text-color":"#1976d2"}},[a("td",[t._v(t._s(t.validatedQuantity))])])],1)])])],1),t.validations?a("v-data-table",{key:t.validations.length,staticStyle:{display:"inline-block"},attrs:{"no-data-text":t.$t("label.nodata"),id:"tableValidations","custom-sort":t.customSort,headers:t.validationsTableHeaders,items:t.validations,"footer-props":{itemsPerPageText:t.$t("label.rows_per_page"),itemsPerPageAllText:t.$t("label.rows_per_page_all")}},scopedSlots:t._u([{key:"item.state",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{color:t.getStateColor(i.state)}},[t._v(t._s(t.getStateName(i.state)))])]}},{key:"item.requestDate",fn:function(e){var i=e.item;return[a("td",{staticClass:"td-style"},[t._v(t._s(t.getFormatedDate(i.requestDate)))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return["validated"!=i.state?a("v-btn",t._g({attrs:{color:"primary",fab:"","x-small":"",dark:"",outlined:""},on:{click:function(e){return t.openValidation(i)}}},s),[a("v-icon",[t._v("mdi-file-document-box-search-outline")])],1):t._e()]}}],null,!0)},[a("span",[t._v(t._s(t.$t("button.open_validation")))])])]}}],null,!1,915237876)}):t._e(),a("v-dialog",{attrs:{"max-width":"80%"},model:{value:t.validationDialog,callback:function(e){t.validationDialog=e},expression:"validationDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v(t._s(t.$t("land.land_validation")))]),t.selectedLand?a("v-card-text",[t._v(t._s(t.$t("land.check_land_details")))]):t._e(),a("v-card",[t.selectedLand?a("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[a("tbody",[a("tr",[a("td",{staticClass:"table-headers-font"},[t._v(t._s(t.$t("label.name")))]),a("td",[t._v(t._s(t.selectedLand.name))]),a("td",{staticClass:"table-headers-font"},[t._v(t._s(t.$t("label.description")))]),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.selectedLand.description))])]),a("tr",[a("td",{staticClass:"table-headers-font"},[t._v(t._s(t.$t("label.district")))]),a("td",[t._v(t._s(t.selectedValidation.districtName))]),a("td",{staticClass:"table-headers-font"},[t._v(t._s(t.$t("label.county")))]),a("td",[t._v(t._s(t.selectedValidation.countyName))]),a("td",{staticClass:"table-headers-font"},[t._v(t._s(t.$t("label.area")))]),a("td",[t._v(" "+t._s(t.getLandAreaHa())+"ha / "+t._s(t.getLandAreaKm())+" km "),a("sup",[t._v("2")])])])])]},proxy:!0}],null,!1,882326926)}):t._e(),a("div",[t.selectedLandImageFiles.length>0?a("div",{staticStyle:{width:"50%",float:"right"}},[a("v-carousel",{staticStyle:{height:"250px"}},t._l(t.selectedLandImageFiles,(function(t,e){return a("v-carousel-item",{key:e,attrs:{src:t.dataUrl,"reverse-transition":"fade-transition",transition:"fade-transition"}})})),1)],1):t._e(),a("div",{staticStyle:{width:"auto",height:"250px",overflow:"hidden"}},[a("v-card",{attrs:{id:"mapPreview"}}),a("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({staticClass:"map-type-btn",attrs:{"x-large":"",color:"primary",fab:"",dark:""},on:{click:function(e){return t.changeMapType()}}},i),[a("v-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isMapTypeSatellite,expression:"!isMapTypeSatellite"}],attrs:{color:"#75ce2e"}},[t._v("mdi-earth-box")]),a("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.isMapTypeSatellite,expression:"isMapTypeSatellite"}],attrs:{color:"#f9df9a"}},[t._v("mdi-map-marker-path")])],1)]}}])},[a("span",[t._v(t._s(t.$t("button.change_map_type")))])])],1)])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showProgressBar,expression:"showProgressBar"}],staticClass:"text-center",staticStyle:{"margin-top":"10px"}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:70,width:7}})],1),t.selectedLandValidationFiles.length>0?a("v-data-table",{staticClass:"elevation-1",staticStyle:{width:"50%"},attrs:{"no-data-text":t.$t("label.nodata"),"hide-default-footer":"",dense:"","hide-default-header":"",headers:t.validationFilesTableHeaders,items:t.selectedLandValidationFiles,"item-key":"name"},scopedSlots:t._u([{key:"item.name",fn:function(e){var i=e.item;return[a("div",{staticStyle:{display:"initial"}},[a("td",{staticClass:"td-style",attrs:{id:"tdItemRow"}},[t._v(t._s(i.name))]),a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-icon",t._g({staticClass:"tdRowIcon pointerCursor downloadIcon",on:{click:function(e){return t.downloadFile(i)}}},s),[t._v("mdi-download")])]}}],null,!0)},[a("span",[t._v(t._s(t.$t("label.download_file")))])])],1)]}}],null,!1,1347254691)}):t._e(),t.selectedLandValidationFiles.length>1?a("v-btn",{staticStyle:{width:"50%"},attrs:{depressed:"",small:"",color:"primary"},on:{click:function(e){return t.downloadAll()}}},[a("v-icon",[t._v("mdi-download")]),t._v(" "+t._s(t.$t("button.downloadall"))+" ")],1):t._e(),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"error"},on:{click:function(e){t.validationDialog=!1}}},[t._v(t._s(t.$t("button.cancel_validation")))]),a("v-btn",{attrs:{color:"success"},on:{click:function(e){return t.validateChosenLand()}}},[t._v(t._s(t.$t("button.validate_land")))])],1)],1)],1)],1)},s=[],n=(a("a4d3"),a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("4e827"),a("a434"),a("b0c0"),a("b65f"),a("e439"),a("dbb4"),a("b64b"),a("acd8"),a("ac1f"),a("1276"),a("159b"),a("2fa7")),o=a("56d7"),l=a("2f62"),r=a("bc7e");function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var u={components:{DistrictsMap:r["a"]},data:function(){return{validationFilesTableHeaders:[{text:"",align:"left",value:"name",sortable:!1}],validationDialog:!1,validations:null,initializedValidations:null,finishedValidations:null,totalValidations:[],currentUser:null,districtsMapCenterCoords:[39.41667,-9.13333],selectedLandValidationFiles:[],selectedLandImageFiles:[],selectedLand:null,selectedValidation:null,showProgressBar:!1,map:null,showValidated:!1,showInitialized:!0}},computed:{initializedQuantity:function(){return this.totalValidations.filter((function(t){return"initialized"==t.state})).length},validatedQuantity:function(){return this.totalValidations.filter((function(t){return"validated"==t.state})).length},validationsTableHeaders:function(){return[{text:this.$t("label.state"),value:"state",width:"1px"},{text:this.$t("label.land"),value:"landName"},{text:this.$t("label.district"),value:"districtName"},{text:this.$t("label.county"),value:"countyName"},{text:this.$t("label.request"),value:"requestDate"},{text:"",value:"action",sortable:!1}]},isMapTypeSatellite:function(){if(this.map&&this.map.getMapTypeId())return"satellite"==this.map.getMapTypeId()},isUserAdminOrManager:function(){return this.currentUser&&("admin"==this.currentUser.category||"manager"==this.currentUser.category)}},watch:{validationDialog:function(t){t||(this.selectedLandValidationFiles=[],this.selectedLandImageFiles=[],this.selectedLand=null,this.selectedValidation=null)},currentUser:function(){this.getValidations()},totalValidations:function(){this.getDistrictNames(),this.getCountysNames(),this.validations=JSON.parse(JSON.stringify(this.totalValidations)),this.resetValidationsTable()},showInitialized:function(t){this.validations=t?this.validations.concat(this.initializedValidations):this.validations.filter((function(t){return"initialized"!=t.state}))},showValidated:function(t){this.validations=t?this.validations.concat(this.finishedValidations):this.validations.filter((function(t){return"validated"!=t.state}))}},mounted:function(){this.getCurrentUser()},methods:c({},Object(l["b"])(["getAllValidations","getProfile","getAllLandFiles","getLand","validateLand"]),{getValidations:function(){var t=this;this.isUserAdminOrManager&&this.getAllValidations().then((function(e){e.data.success&&(t.totalValidations=e.data.result)}))},getCurrentUser:function(){var t=this;this.getProfile().then((function(e){e.data.success&&(t.currentUser=e.data.user,t.isUserAdminOrManager||t.$router.push("/"+t.$i18n.locale+"/profile"))}))},pickedDistrictChanged:function(t){t&&(this.resetValidationsTable(),this.validations=this.validations.filter((function(e){return e.districtCode==t.districtCode})))},pickedCountyChanged:function(t){t&&(this.resetValidationsTable(),this.validations=this.validations.filter((function(e){return e.countyCode==t.countyCode})))},resetValidationsTable:function(){this.validations=this.filterValidationsByCategory(),this.filterValidationsByState()},filterValidationsByCategory:function(){if(this.currentUser){var t=JSON.parse(JSON.stringify(this.totalValidations));if("admin"==this.currentUser.category)return t;for(var e=[],a=0;a<t.length;a++){var i=t[a];"manager"==this.currentUser.category&&(i.districtCode==this.currentUser.managingDistrict?e.push(i):i.countyCode==this.currentUser.managingCounty&&e.push(i))}return e}},filterValidationsByState:function(){if(this.initializedValidations=[],this.finishedValidations=[],this.currentUser)for(var t=0;t<this.validations.length;t++){var e=this.validations[t];switch(e.state){case"initialized":this.initializedValidations.push(e),this.showInitialized||(this.validations.splice(t,1),t--);break;case"validated":this.finishedValidations.push(e),this.showValidated||(this.validations.splice(t,1),t--);break}}},getDistrictNames:function(){var t=a("e32c").geojsonDistricts;this.totalValidations.forEach((function(e){for(var a=0;a<t.features.length;a++){var i=t.features[a];if(i.properties.id==e.districtCode){e.districtName=i.properties.name;break}}}))},getCountysNames:function(){var t=a("e32c").countysCoords;this.totalValidations.forEach((function(e){for(var a=0;a<t.length;a++){var i=t[a];if(i.properties.districtID==e.districtCode){for(var s=0;s<i.features.length;s++){var n=i.features[s];if(n.properties.code==e.countyCode){e.countyName=n.properties.name;break}}break}}}))},getFormatedDate:function(t){return t.substring(0,10)},getStateName:function(t){switch(t){case"initialized":return this.$t("validation.initialized");case"validated":return this.$t("validation.validated")}},getStateColor:function(t){switch(t){case"initialized":return"primary";case"validated":return"success"}},openValidation:function(t){var e=this;this.selectedValidation=t,this.validationDialog=!0;var a={_id:t.landId};this.showProgressBar=!0,this.getAllLandFiles(a).then((function(t){t.data.success&&e.arrangeFiles(t.data.result)})),this.getLand(a).then((function(t){t.data.success&&(e.selectedLand=t.data.result,e.generateSubmitMap(e.selectedLand.centerCoords),e.generateLandPolygon())}))},arrangeFiles:function(t){var e=this;this.selectedLandValidationFiles=[],this.selectedLandImageFiles=[],t.forEach((function(t){"validation"==t.type?e.selectedLandValidationFiles.push(t):e.selectedLandImageFiles.push(t)})),this.showProgressBar=!1},downloadAll:function(){var t=this;this.selectedLandValidationFiles.forEach((function(e){t.downloadFile(e)}))},downloadFile:function(t){var e=document.createElement("a");e.download=t.name,e.href=t.dataUrl,document.body.appendChild(e),e.click(),document.body.removeChild(e)},getLandAreaHa:function(){return Math.trunc(this.selectedLand.area)/1e4},getLandAreaKm:function(){return Math.trunc(this.selectedLand.area)/1e6},generateSubmitMap:function(t){var e=document.getElementById("mapPreview"),i=a("e32c").googleMapOptions;i.zoom=17,i.center={lat:parseFloat(t.split(", ")[0]),lng:parseFloat(t.split(", ")[1])},this.map=new google.maps.Map(e,i)},changeMapType:function(){this.isMapTypeSatellite?this.map.setMapTypeId("roadmap"):this.map.setMapTypeId("satellite")},generateLandPolygon:function(){var t=[],e=this.selectedLand.coords;while(e.length>0){var i=e.substring(e.indexOf("(")+1,e.indexOf(")"));t.push(new google.maps.LatLng(i.split(", ")[0],i.split(", ")[1])),e=e.substring(e.indexOf(")")+1)}var s=a("e32c").bluePolygonColor,n={path:t,strokeColor:s,fillColor:s},o=new google.maps.Polygon(n);o.setMap(this.map)},validateChosenLand:function(){var t=this,e=this;this.validateLand(this.selectedValidation).then((function(a){a.data.success&&(e.validationDialog=!1,e.selectedLand=null,e.selectedValidation=null,e.getValidations(),o["eventBus"].$emit("generateGrowl",{msg:t.$t(a.data.msg),type:"success"}))}))},customSort:function(t,e,a){return t.sort((function(t,i){return a[0]?t[e]+""<i[e]+""?-1:1:i[e]+""<t[e]+""?-1:1})),t}})},h=u,v=(a("72cb"),a("2877")),f=a("6544"),p=a.n(f),m=a("8336"),g=a("b0af"),y=a("99d9"),b=a("5e66"),w=a("3e35"),_=a("cc20"),V=a("8fea"),C=a("169a"),k=a("132d"),L=a("490a"),S=a("1f4f"),x=a("2fa4"),O=a("3a2f"),$=Object(v["a"])(h,i,s,!1,null,"930dd3f2",null);e["default"]=$.exports;p()($,{VBtn:m["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["c"],VCardTitle:y["d"],VCarousel:b["a"],VCarouselItem:w["a"],VChip:_["a"],VDataTable:V["a"],VDialog:C["a"],VIcon:k["a"],VProgressCircular:L["a"],VSimpleTable:S["a"],VSpacer:x["a"],VTooltip:O["a"]})}}]);
//# sourceMappingURL=chunk-5fd143f4.6a7e90e6.js.map